---

title: Data Cleaning

keywords: fastai
sidebar: home_sidebar

summary: "Dieser Bereich bereinigt das zuvor vereinfachte Datenset."
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 02_data_Cleaning.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
    {% raw %}
        
<div class="cell border-box-sizing code_cell rendered">

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autotime
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 2.05 s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 446 µs
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_data" class="doc_header"><code>load_data</code><a href="https://github.com/WFR/community_learning/tree/master/community_learning/data_preparation.py#L12" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_data</code>(<strong><code>path</code></strong>=<em><code>'data/interim/01_train.csv'</code></em>)</p>
</blockquote>
<p>load data</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">()</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">100000</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 25.5 s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>count    100000.000000
mean         40.184390
std          17.358848
min          -1.000000
25%          24.000000
50%          39.000000
75%          51.000000
max         113.000000
Name: age, dtype: float64</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 28.8 ms
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">train</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>ind_empleado</th>
      <th>pais_residencia</th>
      <th>sexo</th>
      <th>age</th>
      <th>ind_nuevo</th>
      <th>antiguedad</th>
      <th>indrel</th>
      <th>indrel_1mes</th>
      <th>tiprel_1mes</th>
      <th>indresi</th>
      <th>indext</th>
      <th>conyuemp</th>
      <th>canal_entrada</th>
      <th>indfall</th>
      <th>tipodom</th>
      <th>cod_prov</th>
      <th>ind_actividad_cliente</th>
      <th>renta</th>
      <th>segmento</th>
      <th>ind_ahor_fin_ult1</th>
      <th>ind_aval_fin_ult1</th>
      <th>ind_cco_fin_ult1</th>
      <th>ind_cder_fin_ult1</th>
      <th>ind_cno_fin_ult1</th>
      <th>ind_ctju_fin_ult1</th>
      <th>ind_ctma_fin_ult1</th>
      <th>ind_ctop_fin_ult1</th>
      <th>ind_ctpp_fin_ult1</th>
      <th>ind_deco_fin_ult1</th>
      <th>ind_deme_fin_ult1</th>
      <th>ind_dela_fin_ult1</th>
      <th>ind_ecue_fin_ult1</th>
      <th>ind_fond_fin_ult1</th>
      <th>ind_hip_fin_ult1</th>
      <th>ind_plan_fin_ult1</th>
      <th>ind_pres_fin_ult1</th>
      <th>ind_reca_fin_ult1</th>
      <th>ind_tjcr_fin_ult1</th>
      <th>ind_valo_fin_ult1</th>
      <th>ind_viv_fin_ult1</th>
      <th>ind_nomina_ult1</th>
      <th>ind_nom_pens_ult1</th>
      <th>ind_recibo_ult1</th>
      <th>fecha_dato_month</th>
      <th>fecha_dato_year</th>
      <th>month_int</th>
      <th>fecha_alta_month</th>
      <th>fecha_alta_year</th>
      <th>fecha_alta_day</th>
      <th>fecha_alta_month_int</th>
      <th>fecha_alta_day_int</th>
      <th>ult_fec_cli_1t_month</th>
      <th>ult_fec_cli_1t_year</th>
      <th>ult_fec_cli_1t_day</th>
      <th>ult_fec_cli_1t_month_int</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9560246</th>
      <td>938020</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>27</td>
      <td>0</td>
      <td>52</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>0</td>
      <td>74750</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>13</td>
      <td>9</td>
      <td>16</td>
      <td>2</td>
      <td>201</td>
      <td>6112</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>913468</th>
      <td>228090</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>71</td>
      <td>0</td>
      <td>172</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>43</td>
      <td>0</td>
      <td>92214</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>6</td>
      <td>12</td>
      <td>75</td>
      <td>2292</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>329218</th>
      <td>292751</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>48</td>
      <td>0</td>
      <td>164</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>27</td>
      <td>0</td>
      <td>44289</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>11</td>
      <td>6</td>
      <td>8</td>
      <td>83</td>
      <td>2528</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>13008483</th>
      <td>55479</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>70</td>
      <td>0</td>
      <td>232</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>28</td>
      <td>1</td>
      <td>137716</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>1</td>
      <td>2</td>
      <td>29</td>
      <td>25</td>
      <td>789</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>535758</th>
      <td>761199</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>49</td>
      <td>0</td>
      <td>33</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>1</td>
      <td>53890</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>13</td>
      <td>16</td>
      <td>160</td>
      <td>4881</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>5004044</th>
      <td>1268042</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>75</td>
      <td>0</td>
      <td>13</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>1</td>
      <td>95471</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>0</td>
      <td>8</td>
      <td>7</td>
      <td>19</td>
      <td>9</td>
      <td>235</td>
      <td>7154</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>11467131</th>
      <td>576205</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>73</td>
      <td>0</td>
      <td>121</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>67</td>
      <td>0</td>
      <td>1</td>
      <td>28</td>
      <td>0</td>
      <td>191146</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>15</td>
      <td>2</td>
      <td>11</td>
      <td>10</td>
      <td>134</td>
      <td>4085</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>5886830</th>
      <td>1199656</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>25</td>
      <td>0</td>
      <td>23</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>28</td>
      <td>0</td>
      <td>110201</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>0</td>
      <td>9</td>
      <td>10</td>
      <td>18</td>
      <td>14</td>
      <td>226</td>
      <td>6884</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>8863728</th>
      <td>534987</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>40</td>
      <td>0</td>
      <td>127</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>1</td>
      <td>-1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>12</td>
      <td>0</td>
      <td>12</td>
      <td>5</td>
      <td>10</td>
      <td>30</td>
      <td>125</td>
      <td>3830</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>8999295</th>
      <td>1431295</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>37</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>12</td>
      <td>0</td>
      <td>1</td>
      <td>28</td>
      <td>0</td>
      <td>89477</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>0</td>
      <td>12</td>
      <td>8</td>
      <td>20</td>
      <td>6</td>
      <td>248</td>
      <td>7546</td>
      <td>12</td>
      <td>0</td>
      <td>24</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 20.5 ms
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="clean_age">clean_age<a class="anchor-link" href="#clean_age">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 957 µs
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="clean_age" class="doc_header"><code>clean_age</code><a href="https://github.com/WFR/community_learning/tree/master/community_learning/data_preparation.py#L17" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>clean_age</code>(<strong><code>df</code></strong>:<code>DataFrame</code>)</p>
</blockquote>
<p>clean age</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>count    100000.000000
mean         40.184390
std          17.358848
min          -1.000000
25%          24.000000
50%          39.000000
75%          51.000000
max         113.000000
Name: age, dtype: float64</pre>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 10 ms
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">clean_age</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">df1</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mi">18</span>
<span class="k">assert</span> <span class="n">df1</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&lt;=</span> <span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;#### before ####&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;#### after ####&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">age</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>
<span class="c1">#del df1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>#### before ####
count    100000.000000
mean         40.267830
std          17.040391
min          18.000000
25%          24.000000
50%          39.000000
75%          50.000000
max         100.000000
Name: age, dtype: float64
#### after ####
count    100000.000000
mean         40.267830
std          17.040391
min          18.000000
25%          24.000000
50%          39.000000
75%          50.000000
max         100.000000
Name: age, dtype: float64
time: 22.3 ms
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>ind_empleado</th>
      <th>pais_residencia</th>
      <th>sexo</th>
      <th>age</th>
      <th>ind_nuevo</th>
      <th>antiguedad</th>
      <th>indrel</th>
      <th>indrel_1mes</th>
      <th>tiprel_1mes</th>
      <th>indresi</th>
      <th>indext</th>
      <th>conyuemp</th>
      <th>canal_entrada</th>
      <th>indfall</th>
      <th>tipodom</th>
      <th>cod_prov</th>
      <th>ind_actividad_cliente</th>
      <th>renta</th>
      <th>segmento</th>
      <th>ind_ahor_fin_ult1</th>
      <th>ind_aval_fin_ult1</th>
      <th>ind_cco_fin_ult1</th>
      <th>ind_cder_fin_ult1</th>
      <th>ind_cno_fin_ult1</th>
      <th>ind_ctju_fin_ult1</th>
      <th>ind_ctma_fin_ult1</th>
      <th>ind_ctop_fin_ult1</th>
      <th>ind_ctpp_fin_ult1</th>
      <th>ind_deco_fin_ult1</th>
      <th>ind_deme_fin_ult1</th>
      <th>ind_dela_fin_ult1</th>
      <th>ind_ecue_fin_ult1</th>
      <th>ind_fond_fin_ult1</th>
      <th>ind_hip_fin_ult1</th>
      <th>ind_plan_fin_ult1</th>
      <th>ind_pres_fin_ult1</th>
      <th>ind_reca_fin_ult1</th>
      <th>ind_tjcr_fin_ult1</th>
      <th>ind_valo_fin_ult1</th>
      <th>ind_viv_fin_ult1</th>
      <th>ind_nomina_ult1</th>
      <th>ind_nom_pens_ult1</th>
      <th>ind_recibo_ult1</th>
      <th>fecha_dato_month</th>
      <th>fecha_dato_year</th>
      <th>month_int</th>
      <th>fecha_alta_month</th>
      <th>fecha_alta_year</th>
      <th>fecha_alta_day</th>
      <th>fecha_alta_month_int</th>
      <th>fecha_alta_day_int</th>
      <th>ult_fec_cli_1t_month</th>
      <th>ult_fec_cli_1t_year</th>
      <th>ult_fec_cli_1t_day</th>
      <th>ult_fec_cli_1t_month_int</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>9560246</th>
      <td>938020</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>27</td>
      <td>0</td>
      <td>52</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>0</td>
      <td>74750</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>13</td>
      <td>9</td>
      <td>16</td>
      <td>2</td>
      <td>201</td>
      <td>6112</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>913468</th>
      <td>228090</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>71</td>
      <td>0</td>
      <td>172</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>43</td>
      <td>0</td>
      <td>92214</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>6</td>
      <td>12</td>
      <td>75</td>
      <td>2292</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>329218</th>
      <td>292751</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>48</td>
      <td>0</td>
      <td>164</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>27</td>
      <td>0</td>
      <td>44289</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>11</td>
      <td>6</td>
      <td>8</td>
      <td>83</td>
      <td>2528</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>13008483</th>
      <td>55479</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>70</td>
      <td>0</td>
      <td>232</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>28</td>
      <td>1</td>
      <td>137716</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>17</td>
      <td>1</td>
      <td>2</td>
      <td>29</td>
      <td>25</td>
      <td>789</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>535758</th>
      <td>761199</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>49</td>
      <td>0</td>
      <td>33</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>1</td>
      <td>53890</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>4</td>
      <td>13</td>
      <td>16</td>
      <td>160</td>
      <td>4881</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>5004044</th>
      <td>1268042</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>75</td>
      <td>0</td>
      <td>13</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>1</td>
      <td>95471</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>0</td>
      <td>8</td>
      <td>7</td>
      <td>19</td>
      <td>9</td>
      <td>235</td>
      <td>7154</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>11467131</th>
      <td>576205</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>73</td>
      <td>0</td>
      <td>121</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>67</td>
      <td>0</td>
      <td>1</td>
      <td>28</td>
      <td>0</td>
      <td>191146</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>1</td>
      <td>15</td>
      <td>2</td>
      <td>11</td>
      <td>10</td>
      <td>134</td>
      <td>4085</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>5886830</th>
      <td>1199656</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>25</td>
      <td>0</td>
      <td>23</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>28</td>
      <td>0</td>
      <td>110201</td>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>0</td>
      <td>9</td>
      <td>10</td>
      <td>18</td>
      <td>14</td>
      <td>226</td>
      <td>6884</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>8863728</th>
      <td>534987</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>40</td>
      <td>0</td>
      <td>127</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>8</td>
      <td>1</td>
      <td>-1</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>12</td>
      <td>0</td>
      <td>12</td>
      <td>5</td>
      <td>10</td>
      <td>30</td>
      <td>125</td>
      <td>3830</td>
      <td>1</td>
      <td>5</td>
      <td>1</td>
      <td>61</td>
    </tr>
    <tr>
      <th>8999295</th>
      <td>1431295</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>37</td>
      <td>1</td>
      <td>4</td>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>-1</td>
      <td>12</td>
      <td>0</td>
      <td>1</td>
      <td>28</td>
      <td>0</td>
      <td>89477</td>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>12</td>
      <td>0</td>
      <td>12</td>
      <td>8</td>
      <td>20</td>
      <td>6</td>
      <td>248</td>
      <td>7546</td>
      <td>12</td>
      <td>0</td>
      <td>24</td>
      <td>12</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 18.3 ms
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="clean_renta">clean_renta<a class="anchor-link" href="#clean_renta">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 2.12 ms
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="clean_renta" class="doc_header"><code>clean_renta</code><a href="https://github.com/WFR/community_learning/tree/master/community_learning/data_preparation.py#L26" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>clean_renta</code>(<strong><code>df</code></strong>:<code>DataFrame</code>)</p>
</blockquote>
<p>fill in NaNs with median value from its region</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df1</span> <span class="o">=</span> <span class="n">clean_renta</span><span class="p">(</span><span class="n">train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 145 ms
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">df1</span><span class="o">.</span><span class="n">renta</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mi">0</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;#### before ####&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">train</span><span class="o">.</span><span class="n">renta</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;#### after ####&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df1</span><span class="o">.</span><span class="n">renta</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="k">del</span> <span class="n">df1</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>#### before ####
count    1.000000e+05
mean     1.065912e+05
std      1.987150e+05
min     -1.000000e+00
25%      4.208675e+04
50%      8.400700e+04
75%      1.376310e+05
max      2.425324e+07
Name: renta, dtype: float64
#### after ####
count    7.966800e+04
mean     1.337945e+05
std      2.143027e+05
min      2.336000e+03
25%      6.890950e+04
50%      1.020210e+05
75%      1.561472e+05
max      2.425324e+07
Name: renta, dtype: float64
time: 10.5 ms
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 68.2 ms
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="clean_all_data" class="doc_header"><code>clean_all_data</code><a href="https://github.com/WFR/community_learning/tree/master/community_learning/data_preparation.py#L44" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>clean_all_data</code>(<strong><code>source</code></strong>:"source csv file"=<em><code>'data/interim/01_train.csv'</code></em>, <strong><code>dest</code></strong>:"destination csv file"=<em><code>'data/interim/02_train.csv'</code></em>)</p>
</blockquote>
<p>main function to clean all data</p>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">train</span> <span class="o">=</span> <span class="n">clean_all_data</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>time: 1min 59s
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">nbdev.export</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">notebook2script</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Converted 00_data_prep.ipynb.
Converted 00_data_preparation.ipynb.
Converted 00_data_preparation_CCA.ipynb.
Converted 01_data_preprocess.ipynb.
Converted 02_data_Cleaning.ipynb.
Converted 03_target_vars.ipynb.
Converted index.ipynb.
time: 173 ms
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}
</div>
 

